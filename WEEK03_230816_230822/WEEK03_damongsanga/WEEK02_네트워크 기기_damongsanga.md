## 2.3 네트워크 기기

### 2.3.1 네트워크 기기의 처리 범위

계층별로 처리할 수 있는 네트워크기기가 존재하며 상위 계층 기기는 하위 계층을 처리할 수 있으나 그 반대는 할 수 없다.

- 애플리케이션 계층 : L7 스위치
- 인터넷 계층 : 라우터, L3 스위치
- 데이터 링크 계층 : L2 스위치, 브리지
- 물리 계층 : NIC, 리피터, AP

### 2.3.2 애플리케이션 계층 처리 기기

##### L7 스위치 (로드밸런서)

- 스위치 : 여러 장비를 연결하고 데이터 통신을 중재, 목적지가 연결된 포트로만 전기신호를 보내 데이터를 전송하는 통신 네트워크 장비
- L7 스위치 (로드밸런서) : 서버의 부하를 분산하여 시스템이 처리할 수 있는 트래픽을 증가시키는 기기
  - 클라이언트로부터 오는 요청들을 뒤쪽의 여러 서버로 나누는 역할
    <br>
  - L4 스위치 vs L7 스위치
    _ L4 스위치
    _ 역시 로드밸런서이지만 전송계층 처리 기기로 스트리밍 관련 서비스에 사용할 수 없음
    _ 메시지 기반 인식 불가능 (L4 계층 단위는 세그먼트, L7 계층 단위가 메시지, 스트리밍)
    _ IP와 포트 기반으로 트래픽 분산
    _ 클라우드 서비스에서 NLB (Network Load Balancer) 컴포넌트로 로드밸런싱
    _ L7 스위치
    _ IP 포트를 포함하여 URL, HTTP 헤더, 쿠키 등을 기반으로 트래픽 분산
    _ 클라우드 서비스에서 ALB (Applicaton Load Balancer) 컴포넌트로 로드밸런싱
    <br>
  ##### 기능
  - 트래픽 분산 : URL, 서버, 캐시, 쿠키를 기반으로 트래픽 분산
  - 필터링 : 바이러스와 불필요한 외부 데이터를 걸러냄
  - 헬스체크 : 장애가 발생한 서버를 트래픽 분산 대상에서 제외하기 위해 정기적으로 서버 감시
    - 전송 주기와 재전송 횟수 등을 설정한 후 반복적으로 서버에 요청을 보내는 것
    - 해당 요청이 제대로 이루어지지 않으면 비정상 서버로 판단 (TCP 요청 시 3-Way-Handshake가 이루어지지 않거나)
    - L4, L7 스위치 모두 헬스체크 사용
  - 서버 이중화
    - 서비스를 안정적으로 운영하기 위해서는 최소 2대 이상의 서버 필수적
    - 가상 IP를 사용자들에게 제공하여 해당 위치로 요청을 받아 장애가 없는 서버의 IP로 서빙하는 것

### 2.3.3 인터넷 계층을 처리하는 기기

##### 라우터

- 여러 네트워크(LAN)를 연결, 분할, 구분 시켜주는 역할
- 라우팅 : 다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고 받을 때 패킷 소모를 최소화하고 경로를 최적화하여 최소 경로로 패킷을 포워딩하는 것
  <https://yozm.wishket.com/magazine/detail/2005/>
- 하드웨어 + 소프트웨어 기반 라우팅

##### L3 스위치

- L2 스위치 기능 + 라우팅 기능 (라우터로 봐도 무방)
- 하드웨어 기반 라우팅

##### 라우터와 스위치의 차이는?

- **라우터 (3계층 장비, 네트워크 간 연결) :** 수신한 패킷의 정보를 보고 경로를 설정해 패킷을 전송하는 역할 수행하는 장비
- **스위치 (2계층 장비, 네트워크 내부 연결) :** 내부 네트워크에 위치하며 **MAC 주소 테이블(MAC 주소 - 포트)** 를 이용해 해당 프레임을 전송하는 장비 **with 이더넷 케이블**
  \*\* 3계층 스위치도 존재 : 가상 LAN 등
- **허브 :** 하나의 전송된 패킷이 허브에 연결된 모든 기기로 브로드캐스팅

### 2.3.4 데이터 링크 계층을 처리하는 기기

##### L2 스위치

- 연결된 장치로부터 패킷이 왔을 때 패킷 전송을 담당
- IP 주소를 이해하지 못해 IP 주소를 기반으로 한 라우팅은 불가능
- 단순히 패킷의 MAC 주소를 읽어 스위칭하는 역할
- 목적지가 MAC 주소 테이블에 없을 시 브로드캐스팅 (ARP 프로토콜 시) & 일정시간 후 MAC 주소 테이블 주소 삭제 기능

| 구분        | L2 스위치       | L3 스위치     |
| ----------- | --------------- | ------------- |
| 참조 테이블 | MAC 주소 테이블 | 라우팅 테이블 |
| 참조 PDU    | 이더넷 프레임   | IP 패킷       |
| 참조 주소   | MAC 주소        | IP 주소       |

##### 브릿지 (Bridge)

- 두 개의 근거리 통신망(LAN)을 상호 접속할 수 있도록 하는 통신망 연결 장치
- 포트와 포트 사이 다리 역할
- MAC 주소 테이블로 MAC 주소 관리
- 브릿지 네트워킹 : 호스트의 네트워크와 게스트의 네트워크를 브릿지하여(연결하여) 게스트 컴퓨터가 네트워킹 하는 방식. 즉, 호스트와 게스트를 하나로 연결하여 두 개의 네트워크를 마치 하나의 네트워크처럼 쓰는 것

### 2.3.5 물리 계층을 처리하는 기기

##### NIC (Network Interface Card) == LAN 카드

- 한 네트워크 안에서 컴퓨터간 신호를 주고받는 데 쓰이는 하드웨어
- 다른데서는 OSI 2계층에 해당된다고 하는데 여기서는 왜 물리 계층이지..?
- PC의 고유 식별번호인 MAC 주소 보관

##### 리피터 (Repeater)

- 약해진 신호를 증폭하여 다른 쪽으로 전달하는 장치
- 패킷이 더 멀리까지 갈 수 있음
- 광케이블의 보급에 따라 잘 사용되지 않음

##### AP (Access Point)

- 패킷을 복사하는 기기
- 유선 LAN -> 무선 LAN
- Wireless Access Point라고 하여 WAP 라고도 한다.
- 일반 소비자 시장의 AP : 인터넷 라우터와 방화벽의 역할을 모두 하는 경우가 많아서 종종 “무선 라우터”라고 불리기도
- 상업 및 산업 부문의 AP : 네트워크 라우팅 기능을 최소화하는 데 도움이 되며 방화벽이 있는 경우는 거의 없음

### +a) 널널한 개발자 TV 설명

#### Host, Switch, Network 관계에 대해

- **Host : 네트워크에 연결된 컴퓨터**
  - **Net 자체를 이루는 Host == Switch :**
    - Router (경로선정), FireWall, IPS (보안)
  - **Net 이용주체인 Host == End-Point(단말) :**
    - Peer, Server, Client
- **Switch :** L2 Switch (MAC), L3 Switch (IP), L4 Switch (Port), L7 Switch (HTTP) (위로 갈 수록 가격 올라감)
- **Network ⇒ Internet 핵심요소 : Router + DNS**
