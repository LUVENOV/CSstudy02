# 4 데이터베이스

## 4.1 데이터베이스의 기본

- 데이터베이스 : 일정한 규칙, 혹은 규약을 통해 구조화되어 저장되는 데이터의 모음
- DBMS (Database Management System) : 해당 데이터베이스를 제어, 관리하는 통합 시스템
- Query Language : 특정 DBMS 마다 정의된 쿼리 언어를 통해 삽입, 삭제, 수정, 조회 등을 수행할 수 있다.
- 특징으로 실시간 접근과 동시 공유가 가능

### 4.1.1 엔터티 (Entity)

- 엔터티(entity) : 사람, 장소, 물건 등 여러 개의 속성(attribute)을 지닌 명사
- 예시 : 회원이라는 엔터티가 있다면 이름, 아이디, 주소, 전화번호 등의 속성을 가진다

- 예시로 A가 B 없이 존재할 수 없을 때
  - 강한 엔터티 : B
  - 약한 엔터티 : A

### 4.1.2 릴레이션 (Relation)

- 릴레이션 (relation) : 데이터베이스에서 정보를 구분하여 저장하는 기본 단위

  - 엔터티에 관한 데이터를 릴레이션 하나에 담아서 관리
  - 엔터티를 데이터베이스에서 관리될 때
  - 관계형 DB : 테이블로 구현
  - NoSQL DB : 컬렉션로 구현

- 엔티티, 테이블, 릴레이션의 차이

  - 엔티티 > 테이블 > 릴레이션 순서로 보면 된다
  - 논리적으로 DB 설계하는 단계에서는 엔티티
  - 이를 특정 DBMS로 구현되는 단계에서 테이블
  - 개념 단계에서 엔터티와 엔터티간의 연관관계를 릴레이션

- 테이블과 컬렉션
  - 관계형 DB : 레코드 - 테이블 - 데이터베이스
    - MySQL
  - NoSQL : 도큐먼트 - 컬렉션 - 데이터베이스
    - MongoDB

### 4.1.3 속성 (Attribute)

- 릴레이션에서 관리하는 구체적이며 고유한 이름을 갖는 정보

### 4.1.4 도메인

- 릴레이션에 포함된 각각의 속성이 가질 수 있는 실제 값의 집합
- 에시로 성별이라는 속성이 있다면 이 때의 도메인은 {남, 여} 가 되겠다.

### 4.1.5 필드와 레코드

- ##### 필드 타입

  - 숫자 타입
    - TINYINT : 1 byte
    - SMALLINT : 2 byte
    - MEDIUMINT : 3 byte
    - INT : 4 byte
    - BIGINT : 8 byte
  - 날짜 타입
    - DATE : 3 byte, 날짜는 있으나 시간은 없음
      - 1000-01-01 ~ 9999-12-31
    - DATETIME : 8 byte, 날짜 및 시간 모두 사용
      - 1000-01-01 00:00:00 ~ 9999-12-31 23:59:59
    - TIMESTAMP : 4 byte, 날짜 및 시간 모두 사용
      - 1000-01-01 00:00:01~ 2038-01-19 03:14:07
  - 문자 타입
    - 괄호 안에 최대 글자 수를 지정 ex) CHAR(30)
    - CHAR : 선언 길이로 고정, 0~255 사이 값
    - VARCHAR : 입력 데이터에 따라 가변 저장, 0~65535 사이 값, 길이기록용 1 byte 추가로 저장

- 레코드 ( == 튜플)

  - 테이블에서의 릴레이션의 각 행

- 책 이라는 엔터티를 정의하고 이를 기반으로 테이블을 만들 때

  1. 엔터티 속성 설정
     - 여러 속성 중 아이디, 출판년도, 생성일지 등..
  2. 속성에 맞는 타입 설정
     - 아이디는 INT, 출판년도는 VARCHAR(255), 생성일시는 DATETIME 등

- TEXT와 BLOB : 모두 큰 데이터를 저장할 때 쓰는 타입

  - TEXT : 큰 문자열 저장에 쓰며 주로 게시판의 본문을 저장할 때 씀
  - BLOB : 이미지, 동영상 과 같은 큰 데이터 저장에 사용
    - 그러나 보통은 아마존 이미지 호스팅 서비스인 S3 등 서버에 파일을 올리고
    - 파일에 관한 경로를 VARCHAR로 저장하는 경우가 많음

- ENUM과 SET : 문자열 열거한 타입
  - **허용된 값만 저장되게끔 제약**
    <br>
  - ENUM
    - ENUM('red', 'blue', 'black') 형태로 쓰이며 이 중에서 하나만 선택하는 단일 선택이 가능
    - ENUM 리스트에 없는 잘못된 값을 삽입하면 빈 문자열이 대신 삽입
    - x-smal 등이 0,1 등으로 매핑되어 메모리를 적게 사용하는 이점
    - 최대 65565개 요소를 넣을 수 있음
  - SET
    - ENUM과 비슷하지만 여러 개의 데이터를 선택할 수 있음
    - 비트 단위의 연산을 할 수 있음
    - 최대 64개 요소를 넣을 수 있음
  - 공간적으로 이점이 있으나 애필리케이션 수정에 따라 데이터 베이스의 ENUM이나 SET에서 정의한 목록을 수정해야하는 단점이 있음

[EUM을 사용하면 안되는 이유](https://velog.io/@leejh3224/%EB%B2%88%EC%97%AD-MySQL%EC%9D%98-ENUM-%ED%83%80%EC%9E%85%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80-%EB%A7%90%EC%95%84%EC%95%BC-%ED%95%A0-8%EA%B0%80%EC%A7%80-%EC%9D%B4%EC%9C%A0)

### 4.1.6 관계

- 관계화살표

  1. 하나의 A로 구성
  2. 하나 이상의 A로 구성
  3. 하나 이하의 A로 구성
  4. 0 또는 하나 이상의 A 로 구성

  - 1 : 1 관계 : 1. + 1.
  - 1 : N 관계 : 1. + 4.
  - N : M 관계 : 1. + 4. && 1. + 4.
    - 1 : N & 1 : M 관계인 테이블 2개

### 4.1.7 키

- 테이블 간의 관계를 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치

- 유일성 : 하나의 키값으로 튜플을 유일하게 식별할 수 있는 성질, 중복이 없어야 함
- 최소성 : 키를 구성하는 속성들 중 꼭 필요한 속성들로만 키를 구성하는 성질

##### 기본키

- PK (Primary Key), 유일성 & 최소성 만족
- 테이블에서 오직 1개만 설정가능
- NULL 가질 수 없음

- 자연키

  - 비즈니스 모델에서 자연스럽게 나오는 속성
  - 변할 위험 존재

- 인조키
  - 비즈니스 모델과 단리 오로지 키 역할을 위해 인조적으로 만든 속성
  - 변할 위험이 존재하지 않아 주로 인조키로 PK 설정

##### 외래키

- FK (Foreign Key), 중복 가능
- 다른 테이블의 기본키를 그대로 참조하는 값으로 개체와의 관계 식별을 위해 사용
- 다른 테이블의 데이터를 참조할 때 없는 값을 참조할 수 없도록 제약을 걸어주는 것
- 참조할 열의 값은 참조될 테이블에서 기본키로 지정되어야!!

##### 후보키

- Candidate Key
- 기본키가 될 수 있는 후보들로 유일성 & 최소성 동시 만족

##### 대체키

- Alternate Key
- 후보키가 2 개 이상인 경우 어느 하나를 기본키로 지정하고 남은 후보키들

##### 슈퍼키

- Super Key
- 유일성만 만족하면 됨
